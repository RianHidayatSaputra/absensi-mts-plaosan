import{r,X as I,j as t,x as L,S as B,A as g}from"./app-NUb6NQg-.js";import{A as O}from"./AuthenticatedLayout-DncdzVuS.js";import{X}from"./index.es-CW1ClXb7.js";import{h as x}from"./moment-C5S46NFB.js";import{S as J}from"./SelectOption-rORhdt3R.js";import{D as V}from"./index-D1N02F7Z.js";import"./sima-DtxtMQ44.js";import"./useIcons-bGyIZvFo.js";import"./objectWithoutProperties-Bdmk7Y0b.js";const{RangePicker:W}=V,$=({filterText:s,onFilter:o})=>{const u=r.useRef(null);return r.useEffect(()=>{u.current&&u.current.focus()},[]),t.jsx("input",{id:"search",ref:u,type:"text",placeholder:"Filter By Name","aria-label":"Search Input",value:s,onChange:o})},se=({auth:s,rekapGuru:o,perPage:u,gurus:v})=>{const[b,j]=r.useState([]),[f,h]=r.useState(o.current_page),[R,m]=r.useState(o.total),[p,S]=r.useState(u||10),[l,y]=r.useState(""),[N,C]=r.useState(l),[i,c]=r.useState(!0),d=r.useRef(null),{url:q}=I(),w=r.useRef([]),k=r.useRef(""),T=o.data.filter(e=>e.guru.nama&&e.guru.nama.toLowerCase().includes(N.toLowerCase()));r.useEffect(()=>(d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{C(l),c(!1)},500),()=>{clearTimeout(d.current)}),[l]),r.useEffect(()=>{m(o.total)},[o]);const H=e=>{const a=e.map(n=>n.format("YYYY-MM-DD"));w.current=a},P=e=>{e.preventDefault();const a=w.current,n=k.current;window.open(route("export-excel/rekap-guru",{dates:a,idGuru:n}),"_self")},A=[{name:"#",cell:(e,a)=>(f-1)*p+a+1,maxwidth:"50px"},{name:"Nama Guru",selector:e=>e.guru.nama,sortable:!0},{name:"Absen Masuk",selector:e=>i?t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}):e.absen_masuk?x(e.absen_masuk,"HH:mm:ss").format("HH:mm"):"-",sortable:!0},{name:"Absen Pulang",selector:e=>i?t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-28 rounded"}):e.absen_pulang?x(e.absen_pulang,"HH:mm:ss").format("HH:mm"):"-",sortable:!0},{name:"Tanggal",selector:e=>i?t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-32 rounded"}):x(e.created_at).format("YYYY-MM-DD"),sortable:!0},{name:"Status",selector:e=>e.status,cell:e=>i?t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-36 rounded"}):t.jsx("span",{style:{whiteSpace:"normal",wordWrap:"break-word"},className:(e.status=="Belum Hadir"?"bg-yellow-500":e.status=="Belum Hadir dan Terlambat"?"bg-orange-500":e.status=="Hadir"?"bg-teal-500":e.status=="Hadir tapi Terlambat"?"bg-teal-300":e.status=="Tidak Hadir"||e.status=="Tidak Absen"?"bg-red-500":"bg-cyan-700")+" px-2 py-1 text-white text-sm font-medium rounded-md inline-block whitespace-nowrap text-center",children:e.status}),width:"150px",sortable:!0}],_=[...Array(p)].map((e,a)=>({id:`loading-${a}`,guru:{nama:t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"})}})),D=r.useCallback(e=>{j(e.selectedRows.map(a=>a.id))},[]),G=r.useMemo(()=>{const e=(a,n)=>{a.preventDefault(),window.confirm("Apakah kamu yakin akan menghapusnya?")&&g.get(route("rekap-guru.destroy",[n]))};return t.jsx("button",{onClick:a=>e(a,b),className:"bg-red-400 hover:bg-red-300 no-underline hover:text-gray-900 py-1 px-2 text-md ml-3 rounded text-black font-mediums",children:"Hapus"})},[b]),M=r.useMemo(()=>t.jsxs("div",{className:"w-full -mb-6",children:[t.jsx("p",{className:"text-red-400 italic text-start -mt-7 mb-3 text-xs",children:"*Jika ingin melakukan export, tanggal dan nama guru tidak wajib diisi!"}),s.user.role=="admin"?t.jsxs("div",{className:"w-full flex justify-between",children:[t.jsx(L,{href:route("rekap-guru.create"),className:"bg-violet-300 hover:bg-violet-200 no-underline hover:text-gray-700 pt-2 px-3 rounded text-black font-medium",children:"Tambah"}),t.jsx($,{onFilter:e=>y(e.target.value),filterText:l})]}):"",t.jsxs("div",{className:"mt-3 w-full flex justify-end mb-3",children:[t.jsx("div",{children:t.jsx(W,{onChange:e=>H(e),className:"mr-3 p-2"})}),s.user.role=="admin"?t.jsxs(J,{className:"h-10 w-44",onChange:e=>{k.current=e.target.value},defaultValue:"",children:[t.jsx("option",{value:"",children:"Pilih Guru"}),v.map((e,a)=>t.jsx("option",{value:e.id,children:e.nama},a))]}):"",t.jsx("button",{onClick:P,className:"bg-teal-400 hover:bg-teal-300 no-underline hover:text-gray-90 py-2 px-3 mb-5 ml-2 rounded text-black font-medium",children:"Export"})]})]}),[l]),Y=e=>{c(!0),g.get(route("rekap-guru.index",{page:e,perPage:p}),{},{replace:!0,preserveState:!0,onSuccess:a=>{h(a.props.rekapGuru.current_page),m(a.props.rekapGuru.total),c(!1)}})},E=async(e,a)=>{S(e),c(!0),g.get(route("rekap-guru.index",{page:a,perPage:e}),{},{replace:!0,preserveState:!0,onSuccess:n=>{h(n.props.rekapGuru.current_page),m(n.props.rekapGuru.total),c(!1)}})},F={rowsPerPageText:"Count Rows",rangeSeparatorText:"de",selectAllRowsItem:!0,selectAllRowsItemText:"Semua"};return t.jsxs(O,{user:s,children:[t.jsx(B,{title:"Rekap Guru"}),t.jsx("div",{className:"mx-6 grid grid-cols-1 xl:grid-cols-1 grid-rows-1 grid-flow-row-dense ",children:t.jsx("div",{className:"xl:col-span-2",children:t.jsx("div",{className:"card h-full shadow mb-4",children:t.jsx(X,{title:"Rekap Guru",columns:A,data:i?_:T,pagination:!0,paginationServer:!0,paginationTotalRows:R,paginationDefaultPage:f,onChangePage:Y,onChangeRowsPerPage:E,selectableRows:s.user.role=="admin",contextActions:s.user.role=="admin"?G:null,onSelectedRowsChange:s.user.role=="admin"?D:void 0,responsive:!0,highlightOnHover:!0,striped:!0,subHeader:!0,subHeaderComponent:M,paginationComponentOptions:F})})})})]})};export{se as default};
