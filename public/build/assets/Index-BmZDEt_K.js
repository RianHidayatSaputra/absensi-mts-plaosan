import{r as a,j as t,x as E,S as F,A as g}from"./app-CfXFyYt-.js";import{A as M}from"./AuthenticatedLayout-QlSnEbba.js";import{h as x}from"./moment-C5S46NFB.js";import{X as D}from"./index.es-EoOjpoTx.js";import{S as L}from"./SelectOption-Cn_cSlG8.js";import"./sima-DtxtMQ44.js";const Y=({filterText:d,onFilter:r})=>{const n=a.useRef(null);return a.useEffect(()=>{n.current&&n.current.focus()},[]),t.jsx("input",{id:"search",ref:n,type:"text",placeholder:"Filter By Name","aria-label":"Search Input",value:d,onChange:r})},z=({auth:d,rekapSiswa:r,perPage:n})=>{const[h,f]=a.useState([]),[w,b]=a.useState(r.current_page),[v,m]=a.useState(r.total),[p,j]=a.useState(n||10),[o,S]=a.useState(""),[k,y]=a.useState(o),[l,i]=a.useState(!0),u=a.useRef(null),R=r.data.filter(e=>e.siswa.nama_siswa&&e.siswa.nama_siswa.toLowerCase().includes(k.toLowerCase()));a.useEffect(()=>(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{y(o),i(!1)},500),()=>{clearTimeout(u.current)}),[o]),a.useEffect(()=>{m(r.total)},[r]);const T=e=>{e.preventDefault(),window.open(route("export-excel.rekap-siswa",{kelas:localStorage.getItem("kelas")}),"_self")},A=[{name:"#",cell:(e,s)=>(w-1)*p+s+1,maxwidth:"50px"},{name:"Nama Siswa",selector:e=>e.siswa.nama_siswa,sortable:!0},{name:"Absen Masuk",selector:e=>l?t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}):e.absen_masuk?x(e.absen_masuk,"HH:mm:ss").format("HH:mm"):"-",sortable:!0},{name:"Absen Pulang",selector:e=>l?t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-28 rounded"}):e.absen_pulang?x(e.absen_pulang,"HH:mm:ss").format("HH:mm"):"-",sortable:!0},{name:"Tanggal",selector:e=>l?t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-32 rounded"}):x(e.created_at).format("YYYY-MM-DD"),sortable:!0},{name:"Status",selector:e=>e.status,cell:e=>l?t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-36 rounded"}):t.jsx("span",{style:{whiteSpace:"normal",wordWrap:"break-word"},className:(e.status=="Belum Hadir"?"bg-yellow-500":e.status=="Belum Hadir dan Terlambat"?"bg-orange-500":e.status=="Hadir"?"bg-teal-500":e.status=="Hadir tapi Terlambat"?"bg-teal-300":e.status=="Tidak Hadir"||e.status=="Tidak Absen"?"bg-red-500":"bg-cyan-700")+" px-2 py-1 text-white text-sm font-medium rounded-md inline-block whitespace-nowrap text-center",children:e.status}),width:"150px",sortable:!0}],C=[...Array(p)].map((e,s)=>({id:`loading-${s}`,siswa:{nama_siswa:t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"})}})),H=a.useCallback(e=>{f(e.selectedRows.map(s=>s.id))},[]),N=a.useMemo(()=>{const e=(s,c)=>{s.preventDefault(),window.confirm("Apakah kamu yakin akan menghapusnya?")&&g.get(route("rekap-siswa.destroy",[c]))};return t.jsx("button",{onClick:s=>e(s,h),className:"bg-red-400 hover:bg-red-300 no-underline hover:text-gray-900 py-1 px-2 text-md ml-3 rounded text-black font-mediums",children:"Hapus"})},[h]),P=a.useMemo(()=>t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"w-full flex justify-between",children:[t.jsx(E,{href:route("rekap-siswa.create"),className:"bg-violet-300 hover:bg-violet-200 no-underline hover:text-gray-700 pt-2 px-3 rounded text-black font-medium",children:"Tambah"}),t.jsx(Y,{onFilter:e=>S(e.target.value),filterText:o})]}),t.jsxs("div",{className:"mt-3 w-full flex justify-end",children:[t.jsxs(L,{className:"h-10",onChange:e=>localStorage.setItem("kelas",e.target.value),children:[t.jsx("option",{value:"",children:"Pilih Kelas"}),t.jsx("option",{value:"7A",children:"7A"}),t.jsx("option",{value:"7B",children:"7B"}),t.jsx("option",{value:"8A",children:"8A"}),t.jsx("option",{value:"8B",children:"8B"}),t.jsx("option",{value:"9A",children:"9A"}),t.jsx("option",{value:"9B",children:"9B"})]}),t.jsx("button",{onClick:T,className:"bg-teal-400 hover:bg-teal-300 no-underline hover:text-gray-90 py-2 px-3 mb-5 ml-2 rounded text-black font-medium",children:"Export"})]})]}),[o]),_=e=>{i(!0),g.get(route("rekap-siswa.index",{page:e,perPage:p}),{},{replace:!0,preserveState:!0,onSuccess:s=>{b(s.props.rekapSiswa.current_page),m(s.props.rekapSiswa.total),i(!1)}})},B=async(e,s)=>{j(e),i(!0),g.get(route("rekap-siswa.index",{page:s,perPage:e}),{},{replace:!0,preserveState:!0,onSuccess:c=>{b(c.props.rekapSiswa.current_page),m(c.props.rekapSiswa.total),i(!1)}})},I={rowsPerPageText:"Count Rows",rangeSeparatorText:"de",selectAllRowsItem:!0,selectAllRowsItemText:"Semua"};return t.jsxs(M,{user:d,children:[t.jsx(F,{title:"Rekap Siswa"}),t.jsx("div",{className:"mx-6 grid grid-cols-1 xl:grid-cols-1 grid-rows-1 grid-flow-row-dense ",children:t.jsx("div",{className:"xl:col-span-2",children:t.jsx("div",{className:"card h-full shadow mb-4",children:t.jsx(D,{title:"Rekap Siswa",columns:A,data:l?C:R,pagination:!0,paginationServer:!0,paginationTotalRows:v,paginationDefaultPage:w,onChangePage:_,onChangeRowsPerPage:B,selectableRows:!0,contextActions:N,onSelectedRowsChange:H,responsive:!0,highlightOnHover:!0,striped:!0,subHeader:!0,subHeaderComponent:P,paginationComponentOptions:I})})})})]})};export{z as default};
