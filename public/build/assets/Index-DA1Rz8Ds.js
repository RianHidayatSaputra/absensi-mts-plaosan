import{r as s,j as a,x as E,S as F,A as m}from"./app-NUb6NQg-.js";import{F as I,a as O,A as B}from"./AuthenticatedLayout-DncdzVuS.js";import{h}from"./moment-C5S46NFB.js";import{X as K}from"./index.es-CW1ClXb7.js";import{S as L}from"./SelectOption-rORhdt3R.js";import{D as X}from"./index-D1N02F7Z.js";import"./sima-DtxtMQ44.js";import"./useIcons-bGyIZvFo.js";import"./objectWithoutProperties-Bdmk7Y0b.js";const{RangePicker:W}=X,ee=({auth:f,rekapSiswa:n,perPage:k,kelas:v})=>{const[b,S]=s.useState([]),[w,p]=s.useState(n.current_page),[j,g]=s.useState(n.total),[i,y]=s.useState(k||10),[o,l]=s.useState(!0),u=s.useRef([]),x=s.useRef(""),[c,d]=s.useState({dates:[],kelas:""});s.useEffect(()=>{g(n.total);const e=setTimeout(()=>{l(!1)},500);return()=>clearTimeout(e)},[n]);const R=e=>{e.preventDefault(),window.open(route("export-excel.rekap-siswa",{dates:u.current,kelas:x.current}),"_self")},N=e=>{if(Array.isArray(e)&&e.length===2&&e[0]&&e[1]){const t=e.map(r=>r.format("YYYY-MM-DD"));u.current=t,d(r=>({...r,dates:t}))}else u.current=null,d(t=>({...t,dates:null}))},H=()=>{const e=u.current,t=x.current;d({dates:e,kelas:t}),p(1),d(r=>({...r,kelas:t})),m.get(route("rekap-siswa.index"),{page:1,perPage:i,dates:e,kelas:t},{preserveState:!0,replace:!0})},A=[{name:"#",cell:(e,t)=>(w-1)*i+t+1,width:"80px"},{name:"Nama Siswa",selector:e=>e.siswa.nama_siswa,sortable:!0},{name:"Absen Masuk",selector:e=>o?a.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}):e.absen_masuk?h(e.absen_masuk,"HH:mm:ss").format("HH:mm"):"-",sortable:!0},{name:"Absen Pulang",selector:e=>o?a.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-28 rounded"}):e.absen_pulang?h(e.absen_pulang,"HH:mm:ss").format("HH:mm"):"-",sortable:!0},{name:"Tanggal",selector:e=>o?a.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-32 rounded"}):h(e.created_at).format("YYYY-MM-DD"),sortable:!0},{name:"Status",selector:e=>e.status,cell:e=>o?a.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-36 rounded"}):a.jsx("span",{style:{whiteSpace:"normal",wordWrap:"break-word"},className:(e.status=="Belum Hadir"?"bg-yellow-500":e.status=="Belum Hadir dan Terlambat"?"bg-orange-500":e.status=="Hadir"?"bg-teal-500":e.status=="Hadir tapi Terlambat"?"bg-teal-300":e.status=="Tidak Hadir"||e.status=="Tidak Absen"?"bg-red-500":"bg-cyan-700")+" px-2 py-1 text-white text-sm font-medium rounded-md inline-block whitespace-nowrap text-center",children:e.status}),width:"150px",sortable:!0}],P=[...Array(i)].map((e,t)=>({id:`loading-${t}`,siswa:{nama_siswa:a.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"})}})),C=s.useCallback(e=>{S(e.selectedRows.map(t=>t.id))},[]),T=s.useMemo(()=>{const e=(t,r)=>{t.preventDefault(),window.confirm("Apakah kamu yakin akan menghapusnya?")&&m.get(route("rekap-siswa.destroy",[r]))};return a.jsx("button",{onClick:t=>e(t,b),className:"bg-red-400 hover:bg-red-300 no-underline hover:text-gray-900 py-1 px-2 text-md ml-3 rounded text-black font-mediums",children:"Hapus"})},[b]),_=s.useMemo(()=>a.jsx("div",{className:"w-full",children:a.jsxs("div",{className:"w-full flex justify-between",children:[a.jsx(E,{href:route("rekap-siswa.create"),className:"bg-violet-300 hover:bg-violet-200 no-underline h-10 hover:text-gray-700 pt-2 px-3 rounded text-black font-medium",children:"Tambah"}),a.jsxs("div",{className:" w-full flex justify-end",children:[a.jsx("div",{children:a.jsx(W,{onChange:e=>N(e),className:"mr-3 p-2"})}),a.jsxs(L,{className:"h-10",onChange:e=>{x.current=e.target.value},children:[a.jsx("option",{value:"",children:"Pilih Kelas"}),v.map((e,t)=>a.jsx("option",{value:e.id,children:e.nama_kelas},t))]}),a.jsx("button",{onClick:H,className:"bg-indigo-600 h-9 hover:bg-indigo-500 ml-2 py-2 no-underline hover:text-gray-700 px-3 rounded text-white font-medium",children:a.jsx(I,{icon:O})}),a.jsx("button",{onClick:R,className:"bg-teal-400 hover:bg-teal-300 no-underline hover:text-gray-90 py-2 px-3 mb-5 ml-2 rounded text-black font-medium",children:"Export"})]})]})}),[]),M=e=>{l(!0),m.get(route("rekap-siswa.index",{page:e,perPage:i,dates:c.dates,kelas:c.kelas}),{},{replace:!0,preserveState:!0,onSuccess:t=>{p(t.props.rekapSiswa.current_page),g(t.props.rekapSiswa.total),l(!1)}})},Y=async(e,t)=>{y(e),l(!0),m.get(route("rekap-siswa.index",{page:t,perPage:e,dates:c.dates,kelas:c.kelas}),{},{replace:!0,preserveState:!0,onSuccess:r=>{p(r.props.rekapSiswa.current_page),g(r.props.rekapSiswa.total),l(!1)}})},D={rowsPerPageText:"Count Rows",rangeSeparatorText:"de",selectAllRowsItem:!0,selectAllRowsItemText:"Semua"};return a.jsxs(B,{user:f,children:[a.jsx(F,{title:"Rekap Siswa"}),a.jsx("div",{className:"mx-6 grid grid-cols-1 xl:grid-cols-1 grid-rows-1 grid-flow-row-dense ",children:a.jsx("div",{className:"xl:col-span-2",children:a.jsx("div",{className:"card h-full shadow mb-4",children:a.jsx(K,{title:"Rekap Siswa",columns:A,data:o?P:n.data,pagination:!0,paginationServer:!0,paginationTotalRows:j,paginationDefaultPage:w,onChangePage:M,onChangeRowsPerPage:Y,selectableRows:!0,contextActions:T,onSelectedRowsChange:C,responsive:!0,highlightOnHover:!0,striped:!0,subHeader:!0,subHeaderComponent:_,paginationComponentOptions:D})})})})]})};export{ee as default};
