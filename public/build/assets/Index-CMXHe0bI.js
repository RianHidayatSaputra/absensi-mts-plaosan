import{r as a,j as t,x as b,S as F,A as w,G as H}from"./app-CfXFyYt-.js";import{A as D}from"./AuthenticatedLayout-QlSnEbba.js";import{X as L}from"./index.es-EoOjpoTx.js";import"./sima-DtxtMQ44.js";const O=({filterText:l,onFilter:r})=>{const n=a.useRef(null);return a.useEffect(()=>{n.current&&n.current.focus()},[]),t.jsx("input",{id:"search",ref:n,type:"text",placeholder:"Filter By Name","aria-label":"Search Input",value:l,onChange:r})},M=()=>{const{setData:l,post:r,reset:n,processing:d}=H({file:""}),x=o=>{o.preventDefault(),r(route("import-siswa"),{onSuccess:()=>{n("file");const i=document.querySelector('input[type="file"]');i&&(i.value=null)}})};return t.jsxs("form",{method:"post",onSubmit:o=>x(o),className:"flex p-2",encType:"multipart/form-data",children:[t.jsx("input",{type:"file",className:"form-control border h-6",onChange:o=>l("file",o.target.files[0]),required:!0}),t.jsx("button",{type:"submit",disabled:d,className:"hover:bg-green-200 py-1 no-underline hover:text-gray-700 px-2 ml-3 mb-5 rounded text-black text-sm font-medium",style:{backgroundColor:"#4EE454"},children:"Import"})]})},G=({auth:l,siswa:r,perPage:n})=>{const[d,x]=a.useState([]),[o,i]=a.useState(r.current_page),[v,g]=a.useState(r.total),[h,y]=a.useState(n||10),[u,S]=a.useState(""),[j,N]=a.useState(u),[f,c]=a.useState(!0),m=a.useRef(null),k=r.data.filter(e=>e.nama_siswa&&e.nama_siswa.toLowerCase().includes(j.toLowerCase()));a.useEffect(()=>(m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{N(u),c(!1)},500),()=>{clearTimeout(m.current)}),[u]),a.useEffect(()=>{g(r.total)},[r]);const C=[{name:"#",cell:(e,s)=>(o-1)*h+s+1,maxwidth:"50px"},{name:"Nama Siswa",selector:e=>e.nama_siswa,cell:e=>t.jsx("div",{style:{whiteSpace:"normal",wordWrap:"break-word"},children:e.nama_siswa}),sortable:!0,width:"200px"},{name:"NIS",selector:e=>e.nis,sortable:!0},{name:"Kelas",selector:e=>e.kelas.nama_kelas,sortable:!0},{name:"Nama Ortu",selector:e=>e.nama_ortu,cell:e=>t.jsx("div",{style:{whiteSpace:"normal",wordWrap:"break-word"},children:e.nama_ortu}),sortable:!0,width:"150px"},{name:"Nomor Ortu",selector:e=>e.no_ortu,cell:e=>t.jsx("div",{style:{whiteSpace:"normal",wordWrap:"break-word"},children:e.no_ortu}),sortable:!0,width:"150px"},{name:"Aksi",cell:e=>f?t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-32 rounded"}):t.jsx(b,{href:route("siswa.edit",e.id),className:"bg-yellow-400 hover:bg-yellow-300 text-sm no-underline hover:text-gray-900 py-1 px-2 rounded text-black font-medium ",children:"Edit"}),maxwidth:"50px"}],R=[...Array(h)].map((e,s)=>({id:`loading-${s}`,nama_siswa:t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-24 rounded"}),nis:t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-20 rounded"}),kelas:t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-28 rounded"}),nama_ortu:t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-32 rounded"}),no_ortu:t.jsx("div",{className:"animate-pulse bg-gray-300 h-4 w-36 rounded"})})),T=a.useCallback(e=>{x(e.selectedRows.map(s=>s.id))},[]),_=a.useMemo(()=>{const e=(s,p)=>{s.preventDefault(),window.confirm("Apakah kamu yakin akan menghapusnya?")&&w.get(route("siswa.destroy",[p]))};return t.jsx("button",{onClick:s=>e(s,d),className:"bg-red-400 hover:bg-red-300 no-underline hover:text-gray-900 py-1 px-2 text-md ml-3 rounded text-black font-mediums",children:"Hapus"})},[d]),P=a.useMemo(()=>t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"w-full flex justify-between",children:[t.jsx(b,{href:route("siswa.create"),className:"bg-violet-300 hover:bg-violet-200 no-underline hover:text-gray-700 pt-2 px-3 rounded text-black font-medium",children:"Tambah"}),t.jsx(O,{onFilter:e=>S(e.target.value),filterText:u})]}),t.jsxs("div",{className:"mt-3 -ms-2",children:[t.jsx("div",{className:"w-80",children:t.jsx(M,{})}),t.jsx("div",{className:" -mt-20",children:t.jsx("a",{href:route("download-template-siswa"),className:"hover:bg-green-200 py-2 no-underline hover:text-gray-700 px-3 rounded text-black text-sm font-medium",style:{backgroundColor:"#4EE454"},children:"Download Template"})})]})]}),[u]),A=e=>{c(!0),w.get(route("siswa.index",{page:e,perPage:h}),{},{replace:!0,preserveState:!0,onSuccess:s=>{i(s.props.siswa.current_page),g(s.props.siswa.total),c(!1)}})},E=async(e,s)=>{y(e),c(!0),w.get(route("siswa.index",{page:s,perPage:e}),{},{replace:!0,preserveState:!0,onSuccess:p=>{i(p.props.siswa.current_page),g(p.props.siswa.total),c(!1)}})},I={rowsPerPageText:"Count Rows",rangeSeparatorText:"de",selectAllRowsItem:!0,selectAllRowsItemText:"Semua"};return t.jsxs(D,{user:l,children:[t.jsx(F,{title:"Siswa"}),t.jsx("div",{className:"mx-6 grid grid-cols-1 xl:grid-cols-1 grid-rows-1 grid-flow-row-dense ",children:t.jsx("div",{className:"xl:col-span-2",children:t.jsx("div",{className:"card h-full shadow mb-5",children:t.jsx(L,{title:"Siswa",columns:C,data:f?R:k,pagination:!0,paginationServer:!0,paginationTotalRows:v,paginationDefaultPage:o,onChangePage:A,onChangeRowsPerPage:E,selectableRows:!0,contextActions:_,onSelectedRowsChange:T,responsive:!0,highlightOnHover:!0,striped:!0,subHeader:!0,subHeaderComponent:P,paginationComponentOptions:I})})})})]})};export{G as default};
